ARG BUILDPLATFORM="linux/amd64"
ARG NODE_VERSION="24.4.0"
ARG GOROOT="/usr/local/go"
ARG GOPATH="/usr/local/gopath"
ARG GO_VERSION="1.24.5"
ARG WAILS_VERSION="2.10.2"
ARG AIR_VERSION="1.62.0"

FROM --platform=$BUILDPLATFORM mcr.microsoft.com/vscode/devcontainers/base:ubuntu-22.04

ARG NODE_VERSION
ARG GOROOT
ARG GOPATH
ARG GO_VERSION
ARG WAILS_VERSION
ARG AIR_VERSION

# Install golang
RUN mkdir -p $GOROOT \
    && mkdir -p $GOPATH \
    && wget "https://go.dev/dl/go$GO_VERSION.linux-amd64.tar.gz" \
    && tar -xzf go$GO_VERSION.linux-amd64.tar.gz -C $GOROOT --strip-components=1 \
    && rm go$GO_VERSION.linux-amd64.tar.gz

ENV GOROOT=$GOROOT \
    GOPATH=$GOPATH \
    PATH="$GOROOT/bin:$GOPATH/bin:$PATH"

# Install Node.js
RUN wget "https://nodejs.org/download/release/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz" \
    && tar -xf node-v$NODE_VERSION-linux-x64.tar.xz -C /usr/local

ENV PATH="/usr/local/node-v$NODE_VERSION-linux-x64/bin:${PATH}"

# Install Air CLI
RUN go install "github.com/air-verse/air@v$AIR_VERSION"

# Install Wails CLI
RUN go install "github.com/wailsapp/wails/v2/cmd/wails@v$WAILS_VERSION"
